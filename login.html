<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login / Sign Up</title>

<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

const SUPABASE_URL = "https://iecnioogmafgxwarmkxz.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImllY25pb29nbWFmZ3h3YXJta3h6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3OTYwNDgsImV4cCI6MjA4MzM3MjA0OH0.3zkHQpwdYUVdf6_GkPfkLRu7xgWMaUHNuFmYMBgBsJA";

window.supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
</script>

<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:#f8f9fa;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.container{
  background:#fff;
  padding:40px 30px;
  border-radius:15px;
  width:500px;
  max-width:95%;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
}
h2{text-align:center;margin-bottom:25px;}
.toggle-btns{display:flex;justify-content:center;margin-bottom:20px;}
.toggle-btns button{
  flex:1;margin:0 5px;padding:10px;border:none;border-radius:8px;
}
.toggle-btns button.active{background:#4b49ac;color:#fff;}
form{display:none;flex-direction:column;}
input,select{padding:10px;margin:5px 0;border-radius:6px;}
button{padding:12px;margin-top:10px;background:#4b49ac;color:#fff;border:none;border-radius:6px;}
</style>
</head>

<body>

<div class="container">
<h2>Welcome</h2>

<div class="toggle-btns">
<button id="btnLogin" class="active">Login</button>
<button id="btnSignUp">Sign Up</button>
</div>

<form id="loginForm" style="display:flex;">
<input id="loginEmail" placeholder="Email">
<input id="loginPassword" type="password" placeholder="Password">
<button type="button" id="loginSubmit">Login</button>
</form>

<form id="signupForm">
<input id="signupFirstName" placeholder="First Name">
<input id="signupLastName" placeholder="Last Name">
<input id="signupDOB" type="date">
<input id="signupCountry" placeholder="Country">
<input id="signupEmail" placeholder="Email">
<input id="signupPassword" type="password" placeholder="Password">
<button type="button" id="signupSubmit">Sign Up</button>
</form>
</div>

<script type="module">
const btnLogin = document.getElementById('btnLogin');
const btnSignUp = document.getElementById('btnSignUp');
const loginForm = document.getElementById('loginForm');
const signupForm = document.getElementById('signupForm');

btnLogin.onclick = ()=>{
  btnLogin.classList.add('active');
  btnSignUp.classList.remove('active');
  loginForm.style.display='flex';
  signupForm.style.display='none';
};

btnSignUp.onclick = ()=>{
  btnSignUp.classList.add('active');
  btnLogin.classList.remove('active');
  signupForm.style.display='flex';
  loginForm.style.display='none';
};

// LOGIN
document.getElementById('loginSubmit').onclick = async ()=>{
  const email = loginEmail.value;
  const password = loginPassword.value;
  const { error } = await supabase.auth.signInWithPassword({ email, password });
  if(error) return alert(error.message);
  window.location.href="dashboard.html";
};

// SIGN UP
document.getElementById('signupSubmit').onclick = async ()=>{
  const email = signupEmail.value;
  const password = signupPassword.value;
  const first_name = signupFirstName.value;
  const last_name = signupLastName.value;
  const dob = signupDOB.value;
  const country = signupCountry.value;

  const { error } = await supabase.auth.signUp({ email, password });
  if(error) return alert(error.message);

  const { error: insertError } = await supabase.from('users').insert([
    {
      email,
      first_name,
      last_name,
      dob,
      country,
      usdt_balance: 0,
      btc_balance: 0,
      user_id: ""
    }
  ]);

  if(insertError) return alert(insertError.message);

  window.location.href="dashboard.html";
};
</script>

</body>
</html>
