<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Deposit | Novabit</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="coins.js"></script>
<script src="wallets.js"></script>

<style>
body {margin:0;font-family:Roboto,Arial,sans-serif;background:#f5f6fa;}
header {background:#1a1a2e;color:#fff;padding:15px;display:flex;justify-content:space-between;align-items:center;}
header h3 {margin:0;}
button {cursor:pointer;border:none;border-radius:5px;}
.container {padding:20px;max-width:900px;margin:auto;position:relative;}
.card {background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,.1);margin-bottom:20px;}
input {width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ccc;}
.coin-list {display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:15px;margin-top:10px;}
.coin {border:1px solid #ddd;border-radius:8px;padding:10px;text-align:center;cursor:pointer;}
.coin:hover {border-color:#4b49ac;}
.coin img {width:32px;height:32px;margin-bottom:5px;}
.hidden {display:none;}
#depositModal {position:fixed;top:0;right:-400px;width:33%;max-width:350px;height:100%;background:#fff;box-shadow:-2px 0 6px rgba(0,0,0,0.2);transition:right 0.3s;padding:20px;z-index:200;}
#depositModal.active {right:0;}
#depositModal h3 {margin-top:0;}
#closeModal {background:#e74c3c;color:#fff;padding:8px 12px;margin-bottom:15px;width:100%;cursor:pointer;}
.select-network {width:100%;padding:8px;margin:10px 0;border-radius:6px;border:1px solid #ccc;}
.copy-btn {background:#4b49ac;color:#fff;padding:10px;width:100%;margin-top:10px;cursor:pointer;}
.notice {background:#fff3cd;padding:10px;border-radius:6px;margin-top:10px;font-size:14px;}
#searchInput {width:100%;padding:10px;border-radius:6px;border:1px solid #ccc;margin-bottom:10px;}
</style>
</head>
<body>

<header>
  <h3>Deposit</h3>
  <button onclick="toggleSideMenu()">Menu</button>
</header>

<div class="container">
  <!-- Search -->
  <input type="text" id="searchInput" placeholder="Search Coin..." onkeyup="filterCoins()">

  <!-- Coin List -->
  <div class="coin-list" id="coinList"></div>
</div>

<!-- Deposit Modal (Right Side Panel) -->
<div id="depositModal">
  <button id="closeModal" onclick="closeDeposit()">Close</button>
  <h3 id="coinTitle"></h3>

  <label for="networkSelect"><b>Network:</b></label>
  <select class="select-network" id="networkSelect"></select>

  <div class="address-box" id="walletAddress"></div>
  <button class="copy-btn" onclick="copyAddress()">Copy Address</button>

  <div class="notice">
    ⚠️ Deposit will be credited after manual confirmation.
  </div>
</div>

<script>
const coinList = document.getElementById('coinList');
const depositModal = document.getElementById('depositModal');
const coinTitle = document.getElementById('coinTitle');
const networkSelect = document.getElementById('networkSelect');
const walletAddress = document.getElementById('walletAddress');
const searchInput = document.getElementById('searchInput');

// Render Coins
function renderCoins() {
  coinList.innerHTML = '';
  COINS.forEach(c => {
    let div = document.createElement('div');
    div.className = 'coin';
    div.innerHTML = `<img src="${c.icon}" alt="${c.symbol}"><div>${c.symbol}</div>`;
    div.onclick = () => openDeposit(c.symbol, c.name);
    coinList.appendChild(div);
  });
}

// Filter Coins
function filterCoins() {
  let filter = searchInput.value.toUpperCase();
  document.querySelectorAll('.coin-list .coin').forEach(coin => {
    let txt = coin.innerText.toUpperCase();
    coin.style.display = txt.includes(filter) ? '' : 'none';
  });
}

// Open Deposit Modal
function openDeposit(symbol, name) {
  const wallets = WALLET_ADDRESSES[symbol];
  if(!wallets) { alert('Wallet address not set'); return; }
  coinTitle.innerText = `${name} (${symbol})`;
  
  networkSelect.innerHTML = '';
  wallets.networks.forEach(net => {
    let opt = document.createElement('option');
    opt.value = net;
    opt.innerText = net;
    networkSelect.appendChild(opt);
  });

  // Show first network address
  walletAddress.innerText = wallets.addresses[wallets.networks[0]];

  networkSelect.onchange = () => {
    let net = networkSelect.value;
    walletAddress.innerText = wallets.addresses[net];
  };

  depositModal.classList.add('active');
}

// Close Modal
function closeDeposit() {
  depositModal.classList.remove('active');
}

// Copy Address
function copyAddress() {
  navigator.clipboard.writeText(walletAddress.innerText)
    .then(()=> alert('Address copied!'))
    .catch(()=> alert('Failed to copy'));
}

renderCoins();
</script>

</body>
</html>
